import{j as e,r as v,Y as Q}from"./app-4-9hqyk0.js";import{A as P}from"./AuthenticatedLayout-Dy4UWgix.js";import{d as C}from"./index-BoQJvmTQ.js";import{d as G,A as J}from"./AddToLibraryModal-DJJWIDcU.js";import{a as $,i as A,r as K}from"./Footer-Bk8_I_xS.js";import{B as U,C as X}from"./BookStatusSelector-DIInCn03.js";import{B as T}from"./BasicRating-um-t9R4z.js";import{u as Z}from"./useMediaQuery-CoonmXGH.js";import{B}from"./Box-DadvyvCF.js";import{T as W,a as S}from"./Tab-Dv4FvHO6.js";import"./transition-ClowOTfh.js";import"./LocalLibraryOutlined-DqWFJDyc.js";import"./ButtonBase-BvMl_hVz.js";var M={},k=A;Object.defineProperty(M,"__esModule",{value:!0});var F=M.default=void 0,ee=k($()),se=e;F=M.default=(0,ee.default)((0,se.jsx)("path",{d:"M17 11v6.97l-5-2.14-5 2.14V5h6V3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V11zm4-4h-6V5h6z"}),"BookmarkRemoveOutlined");var D={},le=A;Object.defineProperty(D,"__esModule",{value:!0});var z=D.default=void 0,te=le($()),ae=e;z=D.default=(0,te.default)((0,ae.jsx)("path",{d:"m18.85 10.39 1.06-1.06c.78-.78.78-2.05 0-2.83L18.5 5.09c-.78-.78-2.05-.78-2.83 0l-1.06 1.06zm-4.24 1.42L7.41 19H6v-1.41l7.19-7.19zm-1.42-4.25L4 16.76V21h4.24l9.19-9.19zM19 17.5c0 2.19-2.54 3.5-5 3.5-.55 0-1-.45-1-1s.45-1 1-1c1.54 0 3-.73 3-1.5 0-.47-.48-.87-1.23-1.2l1.48-1.48c1.07.63 1.75 1.47 1.75 2.68M4.58 13.35C3.61 12.79 3 12.06 3 11c0-1.8 1.89-2.63 3.56-3.36C7.59 7.18 9 6.56 9 6c0-.41-.78-1-2-1-1.26 0-1.8.61-1.83.64-.35.41-.98.46-1.4.12-.41-.34-.49-.95-.15-1.38C3.73 4.24 4.76 3 7 3s4 1.32 4 3c0 1.87-1.93 2.72-3.64 3.47C6.42 9.88 5 10.5 5 11c0 .31.43.6 1.07.86z"}),"DrawOutlined");const _=({book:s,auth:r,librariesWithBookCount:N})=>{const[h,x]=v.useState(!1),[p,d]=v.useState(!1),[i,o]=v.useState(""),w=async()=>{let c="Ya no quieres leer este libro?";s.status==="leyendo"?c="¿Seguro que quieres cancelar tu lectura?":s.status==="leido"&&(c="¿Seguro que quieres eliminar tu registro de lectura?"),window.confirm(c)&&await C.Inertia.delete("/deletereading",{data:{user_id:r.user.id,book_id:s.id,status:s.status},preserveScroll:!0,preserveState:!0})},n=async c=>{c.preventDefault();try{await C.Inertia.post("/reviews/store",{book_id:s.id,user_id:r.user.id,review:i}),d(!1)}catch(y){console.error("Error al enviar la reseña:",y)}},g=Z("(max-width:600px)"),j=r.user.role=="user"?"#2C3E50":"#512E5F",b=r.user.role=="user"?"bg-metal":"bg-premium";return e.jsx("div",{className:"card w-full h-[280px] md:h-[250px] flex flex-col flex-1 pb-5 rounded min-w-[263px] border-b-2",children:e.jsxs("div",{className:"w-full max-h-[250px] flex flex-row items-center justify-start",children:[e.jsxs("div",{className:"w-full flex flex-row gap-10",children:[e.jsx("a",{href:route("books.show",s.id),className:"cursor-pointer",children:e.jsx("div",{className:"w-[140px] h-[215px]",children:s.portada?e.jsx("img",{src:s.portada,alt:s.titulo,className:"w-full h-full rounded"}):e.jsx("div",{className:"w-[140px] h-[215px] bg-gray-300 flex items-center justify-center text-center rounded-lg",children:e.jsx("span",{className:"text-2xl font-bold text-gray-600",children:s.titulo})})})},s.id),e.jsxs("div",{className:"w-full max-h-[250px] flex flex-col justify-between",children:[e.jsxs("div",{className:" flex flex-col md:gap-2",children:[e.jsx("h2",{className:"titulo text-lg md:text-2xl font-serif",children:s.titulo}),e.jsxs("p",{className:"autor text-l",children:["by"," ",e.jsx("span",{className:"text-metal cursor-pointer underline italic",onClick:()=>C.Inertia.visit(`/books?autor=${s.autor}`),children:s.autor})]}),e.jsxs("p",{className:"serie text-sm md:text-lg",children:[s.serie?s.serie:"Libro Único"," ",s.num_serie?`#${s.num_serie}`:""]}),e.jsx(T,{book:s,initialRating:s.rate,readonly:s.status!=="leido"})]}),e.jsxs("div",{className:"max-h-[250px] flex flex-row items-end justify-between gap-2",children:[e.jsx("div",{className:"flex flex-row items-start justify-start",children:e.jsx(U,{initialStatus:s.status,book:s,auth:r,showPage:!1})}),e.jsxs("div",{className:"flex flex-col md:flex-row flex-wrap items-center justify-center gap-1 md:gap-5",children:[s.status==="leido"&&s.rate>0&&e.jsx("button",{className:"text-center transition duration-300 ease-in-out",onClick:()=>d(!0),title:"Escribir reseña",children:e.jsx(z,{sx:{fill:j,fontSize:g?"30px":"35px"}})}),e.jsx("button",{className:"text-center transition duration-300 ease-in-out",onClick:()=>x(!0),title:"Añadir a biblioteca",children:e.jsx(G,{sx:{fill:j,fontSize:g?"30px":"35px"}})}),e.jsx("button",{className:"text-center transition duration-300 ease-in-out",onClick:w,title:"Eliminar de la lista de lectura",children:e.jsx(F,{sx:{fill:K[700],fontSize:g?"30px":"35px"}})})]})]})]})]}),h&&e.jsx(J,{book:s,librariesWithBookCount:N,setShowModal:x,auth:r}),p&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"w-full md:w-[30%] bg-white p-5 rounded-lg",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Escribe tu reseña"}),e.jsxs("form",{onSubmit:n,className:"flex flex-col gap-3",children:[e.jsx("textarea",{className:"w-full h-40 p-2 border rounded",value:i,onChange:c=>o(c.target.value),placeholder:"Escribe aquí tu reseña"}),e.jsxs("div",{className:"w-full flex flex-row justify-around gap-5",children:[e.jsx("button",{type:"submit",className:`w-full ${b} text-white p-2 rounded`,children:"Publicar"}),e.jsx("button",{onClick:()=>d(!1),className:"w-full bg-red-500 text-white p-2 rounded",children:"Cancelar"})]})]})]})})]})})};function re({value:s,onChange:r,role:N,want:h,reading:x,read:p}){const d=(g,j)=>{r(j)},i="#3f51b5",o="#000",w=i,n=i;return e.jsx("div",{className:"w-full items-center mb-5",children:e.jsx(B,{sx:{width:"100%",bgcolor:"background.paper"},children:e.jsxs(W,{value:s,onChange:d,variant:"scrollable",scrollButtons:"auto",sx:{"& .MuiTabs-indicator":{backgroundColor:i},"& .MuiTab-root":{color:o,"&:hover":{color:n}},"& .Mui-selected":{color:w}},children:[e.jsx(S,{label:`Quiero Leer (${h})`}),e.jsx(S,{label:`Leyendo (${x})`}),e.jsx(S,{label:`Leido (${p})`}),e.jsx(S,{label:"Resumen Anual"})]})})})}function we({auth:s,wantToReadBooks:r,readingBooks:N,readBooks:h,wantToReadBooksCount:x,readingBooksCount:p,readBooksCount:d,librariesWithBookCount:i}){const[o,w]=v.useState(()=>{const l=localStorage.getItem("selectedSectionReading");return l?parseInt(l):0}),[n,g]=v.useState(new Date().getFullYear());v.useEffect(()=>{localStorage.setItem("selectedSectionReading",o)},[o]);const j=l=>{w(l)},b=l=>{g(parseInt(l.target.value))},c=()=>{const l=h.filter(t=>new Date(t.end_date).getFullYear()===n);if(console.log("Filtered Books: ",l),l.length===0)return e.jsxs("div",{className:"w-full flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"w-[20%] flex flex-col items-center",children:[e.jsx("label",{htmlFor:"year-select",className:"text-lg text-gray-700",children:"Selecciona el Año:"}),e.jsx("select",{id:"year-select",value:n,onChange:b,className:"w-[50%] mt-2 p-2 border rounded",children:[...Array(10).keys()].map(t=>{const a=new Date().getFullYear()-t;return e.jsx("option",{value:a,children:a},a)})})]}),e.jsxs("p",{className:"text-lg text-gray-600",children:["No hay registros de lectura para el año ",n,"."]})]});const L=l.length,E=l.reduce((t,a)=>t+parseInt(a.paginas,10),0),u=l.reduce((t,a)=>parseInt(a.paginas,10)>parseInt(t.paginas,10)?a:t,l[0]||{}),m=l.reduce((t,a)=>parseInt(a.paginas,10)<parseInt(t.paginas,10)?a:t,l[0]||{}),R=l.filter(t=>t.rate!==null&&t.rate!==void 0&&t.rate!==""),I=R.reduce((t,a)=>t+parseFloat(a.rate),0)/R.length||0,f=R.reduce((t,a)=>parseFloat(a.rate)>parseFloat(t.rate)?a:t),q=l.reduce((t,a)=>{const Y=new Date(a.start_date),O=new Date(a.end_date),V=Math.abs(O-Y),H=Math.ceil(V/(1e3*60*60*24));return t+H},0)/L||0;return e.jsxs("div",{className:"w-full flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"w-full md:w-[20%] flex flex-col items-center",children:[e.jsx("label",{htmlFor:"year-select",className:"text-lg text-gray-700",children:"Selecciona el Año:"}),e.jsx("select",{id:"year-select",value:n,onChange:b,className:"w-[50%] mt-2 p-2 border rounded",children:[...Array(10).keys()].map(t=>{const a=new Date().getFullYear()-t;return e.jsx("option",{value:a,children:a},a)})})]}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"w-full flex flex-col items-center bg-white p-4 rounded shadow-md",children:[e.jsx("div",{className:"flex flex-row",children:e.jsxs("h3",{className:"text-xl font-semibold",children:["Has leído ",L," libros en ",n]})}),e.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2",children:l.map(t=>e.jsx("div",{children:e.jsx(X,{book:t})},t.id))})]}),e.jsxs("div",{className:"w-full mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:[e.jsxs("div",{className:"w-full flex flex-col items-center gap-4 bg-white p-4 rounded shadow-md",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Libro más largo"}),e.jsx("img",{src:`${u.portada}`,alt:"",className:"rounded w-[200px] h-[300px]"}),e.jsxs("p",{children:[(u==null?void 0:u.titulo)||"N/A"," (",(u==null?void 0:u.paginas)||0," páginas)"]})]}),e.jsxs("div",{className:"w-full flex flex-col items-center gap-4 bg-white p-4 rounded shadow-md",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Libro más corto"}),e.jsx("img",{src:`${m.portada}`,alt:"",className:"rounded w-[200px] h-[300px]"}),e.jsxs("p",{children:[(m==null?void 0:m.titulo)||"N/A"," (",(m==null?void 0:m.paginas)||0," páginas)"]})]}),e.jsxs("div",{className:"w-full flex flex-col items-center gap-4 bg-white p-4 rounded shadow-md",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Libro más popular"}),e.jsx("img",{src:`${f.portada}`,alt:"",className:"rounded w-[200px] h-[300px]"}),e.jsxs("p",{children:[(f==null?void 0:f.titulo)||"N/A"," (",(f==null?void 0:f.rate)||0," rating)"]})]})]}),e.jsxs("div",{className:"w-full mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:[e.jsxs("div",{className:"bg-white p-4 rounded shadow-md",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Total de Páginas"}),e.jsx("p",{className:"text-2xl",children:E})]}),e.jsxs("div",{className:"bg-white p-4 rounded shadow-md",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Rating Medio"}),e.jsxs("p",{className:"text-2xl",children:[e.jsx(T,{initialRating:I,size:"large",readonly:!0}),I.toFixed(2)]})]}),e.jsxs("div",{className:"bg-white p-4 rounded shadow-md",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Tiempo Medio de Lectura por Libro"}),e.jsxs("p",{className:"text-2xl",children:[q," Días"]})]})]})]})]})},y=()=>{switch(o){case 0:return e.jsx("div",{className:"opacity-100 transition-opacity ease-in-out w-full flex flex-col gap-10",children:x>0?r.map(l=>e.jsx(_,{book:l,auth:s,librariesWithBookCount:i},l.id)):e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-gray-600",children:'No tienes libros en tu lista de "Quiero Leer".'}),e.jsx("a",{href:"/books",className:"text-blue-500 hover:underline",children:"Descubre libros"})]})},0);case 1:return e.jsx("div",{className:"opacity-100 transition-opacity ease-in-out w-full flex flex-col gap-10",children:p>0?N.map(l=>e.jsx(_,{book:l,auth:s,librariesWithBookCount:i},l.id)):e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-gray-600",children:'No tienes libros en tu lista de "Leyendo".'}),e.jsx("a",{href:"/books",className:"text-blue-500 hover:underline",children:"Descubre libros"})]})},1);case 2:return e.jsx("div",{className:"opacity-100 transition-opacity ease-in-out w-full flex flex-col gap-10",children:d>0?h.map(l=>e.jsx(_,{book:l,auth:s,librariesWithBookCount:i},l.id)):e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-gray-600",children:'No tienes libros en tu lista de "Leído".'}),e.jsx("a",{href:"/books",className:"text-blue-500 hover:underline",children:"Descubre libros"})]})},2);case 3:return c();default:return null}};return e.jsxs(P,{user:s.user,children:[e.jsx(Q,{title:"Mis Lecturas"}),e.jsx("div",{className:"w-full h-full flex justify-center items-center",children:e.jsxs("div",{className:"mt-20 w-full max-w-6xl px-4",children:[e.jsx("div",{className:"flex",children:e.jsx(re,{value:o,onChange:j,role:s.user.role,want:x,reading:p,read:d,summary:!0})}),y()]})})]})}export{we as default};
