import{r as u,W as k,j as e,Y as F}from"./app-BZrr-U3K.js";import{A as E}from"./AdminLayout-Bt9sXfrz.js";import{d as _}from"./index-ChmhcNoT.js";import{d as P}from"./DeleteForever-BOLjdCqE.js";import{d as A}from"./Edit-C-_-zzC5.js";import{r as D}from"./Footer-BV1Lm9-O.js";import{A as L}from"./AddButton-CJQ-397H.js";import"./TextInput-RmCuXNnB.js";import{C as U}from"./Loading-a05Cs1sT.js";import"./transition-DQ32GuLJ.js";import"./Box-CfloCBx9.js";const I=({book:s})=>{const[b,p]=u.useState(!1),[i,x]=u.useState({});u.useEffect(()=>()=>{localStorage.setItem("scrollPosition",window.scrollY.toString())},[]);const j=async()=>{confirm("¿Estás seguro de que deseas eliminar este libro?")&&await _.Inertia.delete(route("books.destroy",s.id))},m={titulo:s.titulo,autor:s.autor,serie:s.serie,num_serie:s.num_serie,descripcion:s.descripcion,paginas:s.paginas,portada:"",url_portada:""},{data:a,setData:o,post:f}=k({...m}),r=()=>{const l={};return a.titulo||(l.titulo="El título es obligatorio."),a.autor||(l.autor="El autor es obligatorio."),a.descripcion||(l.descripcion="La descripción es obligatoria."),!a.portada&&!a.url_portada&&(a.paginas||(l.paginas="El número de páginas es obligatorio.")),l},C=async l=>{l.preventDefault();const g=r();if(Object.keys(g).length>0){x(g);return}const d=new FormData;d.append("_method","PATCH"),d.append("titulo",a.titulo.trim()!==""?a.titulo:""),d.append("autor",a.autor.trim()!==""?a.autor:""),d.append("serie",a.serie!=null?a.serie:""),d.append("num_serie",a.num_serie!=null?a.num_serie:""),d.append("descripcion",a.descripcion.trim()!==""?a.descripcion:""),d.append("paginas",a.paginas!=null?a.paginas:""),d.append("portada",a.portada),d.append("url_portada",a.url_portada),await _.Inertia.post(route("books.update",s.id),d,{preserveScroll:!0,preserveState:!0,onSuccess:()=>{const v=window.location.href;history.replaceState(null,null,v)}}),p(!1),o({...m}),x({})},n=()=>{p(!1),o({...m}),x({})},N=()=>{o("portada","")},c=()=>{o("url_portada","")},h=l=>{o("portada",l.target.files[0])},w=l=>{o("url_portada",l.target.value)},y=s.portada?s.portada.startsWith("http")?s.portada:s.portada.replace(/^public\//,"/storage/"):null;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"card flex flex-col gap-3 items-center justify-center p-3 rounded min-w-[263px]",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-5",children:[e.jsx("a",{href:route("books.show",s.id),className:"cursor-pointer",children:e.jsx("div",{children:s.portada?e.jsx("img",{src:y,alt:s.titulo,className:"w-[240px] h-[380px] rounded"}):e.jsxs("div",{className:"w-[240px] h-[380px] bg-gray-300 flex flex-col items-center justify-center text-center rounded-lg",children:[e.jsx("span",{className:"text-2xl font-bold text-gray-600",children:s.titulo}),e.jsxs("span",{className:"font-bold text-gray-600",children:["by ",s.autor]})]})})},s.id),e.jsxs("div",{className:"hidden",children:[e.jsx("h2",{className:"titulo",children:s.titulo}),e.jsx("p",{className:"autor",children:s.autor}),e.jsxs("p",{className:"serie",children:[s.serie?s.serie:"Standalone"," ",s.num_serie?`#${s.num_serie}`:""]})]}),e.jsxs("div",{className:"w-full flex flex-row justify-center items-center gap-2",children:[e.jsx("button",{onClick:()=>p(!0),className:"w-full border-2 border-black text-white font-bold py-2 px-4 rounded",children:e.jsx(A,{sx:{color:"#000"}})}),e.jsx("button",{onClick:j,className:"w-full border-2 border-red-500 text-white font-bold py-2 px-4 rounded",children:e.jsx(P,{sx:{color:D[500]}})})]})]})}),b&&e.jsx("div",{id:"crear",className:"fixed inset-0 z-50 overflow-auto bg-gray-500 bg-opacity-75 flex items-center justify-center",children:e.jsxs("div",{className:"w-full max-w-4xl p-8 bg-white m-6 rounded shadow-lg relative mt-44 md:mt-10",children:[e.jsxs("form",{onSubmit:C,encType:"multipart/form-data",className:"w-full flex flex-col gap-4",children:[e.jsxs("div",{className:"w-full flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"w-full md:w-[50%]",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"titulo",className:"block text-sm font-medium text-gray-700",children:"Título"}),e.jsx("input",{id:"titulo",type:"text",className:"shadow appearance-none border rounded w-full py-2 px-3 text-black focus:outline-none focus:ring-2 focus:ring-metal",value:a.titulo,onChange:l=>o("titulo",l.target.value)}),i.titulo&&e.jsx("p",{className:"text-red-500 text-xs italic",children:i.titulo})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"autor",className:"block text-sm font-medium text-gray-700",children:"Autor"}),e.jsx("input",{id:"autor",type:"text",className:"shadow appearance-none border rounded w-full py-2 px-3 text-black focus:outline-none focus:ring-2 focus:ring-metal",value:a.autor,onChange:l=>o("autor",l.target.value)}),i.autor&&e.jsx("p",{className:"text-red-500 text-xs italic",children:i.autor})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"serie",className:"block text-sm font-medium text-gray-700",children:"Serie"}),e.jsx("input",{id:"serie",type:"text",className:"shadow appearance-none border rounded w-full py-2 px-3 text-black focus:outline-none focus:ring-2 focus:ring-metal",value:a.serie,onChange:l=>o("serie",l.target.value)})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"num_serie",className:"block text-sm font-medium text-gray-700",children:"Número de Serie"}),e.jsx("input",{id:"num_serie",type:"number",className:"shadow appearance-none border rounded w-full py-2 px-3 text-black focus:outline-none focus:ring-2 focus:ring-metal",value:a.num_serie,onChange:l=>o("num_serie",l.target.value)})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"paginas",className:"block text-sm font-medium text-gray-700",children:"Páginas"}),e.jsx("input",{id:"paginas",type:"number",className:"shadow appearance-none border rounded w-full py-2 px-3 text-black focus:outline-none focus:ring-2 focus:ring-metal",value:a.paginas,onChange:l=>o("paginas",l.target.value)}),i.paginas&&e.jsx("p",{className:"text-red-500 text-xs italic",children:i.paginas})]})]}),e.jsxs("div",{className:"w-full md:w-[50%] flex flex-col gap-3",children:[e.jsxs("div",{className:"mb-4 h-full",children:[e.jsx("label",{htmlFor:"descripcion",className:"block text-sm font-medium text-gray-700",children:"Descripción"}),e.jsx("textarea",{id:"descripcion",className:"shadow appearance-none border rounded w-full h-full py-2 px-3 text-black focus:outline-none focus:ring-2 focus:ring-metal",value:a.descripcion,onChange:l=>o("descripcion",l.target.value)}),i.descripcion&&e.jsx("p",{className:"text-red-500 text-xs italic text-end",children:i.descripcion})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"portada",className:"block text-sm font-medium text-gray-700",children:"Portada"}),e.jsxs("div",{className:"flex flex-row gap-2 justify-center items-center",children:[e.jsx("input",{id:"portada",type:"file",className:"shadow appearance-none border rounded w-full py-2 px-3 text-black focus:outline-none focus:ring-2 focus:ring-metal",onChange:h,disabled:a.url_portada!==""}),e.jsx("button",{type:"reset",onClick:N,className:"bg-red-500 text-white font-bold py-1 px-2 rounded",children:"X"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"url_portada",className:"block text-sm font-medium text-gray-700",children:"URL de la Portada"}),e.jsxs("div",{className:"flex flex-row gap-2 justify-center items-center",children:[e.jsx("input",{id:"url_portada",type:"text",className:"shadow appearance-none border rounded w-full py-2 px-3 text-black focus:outline-none focus:ring-2 focus:ring-metal",value:a.url_portada,onChange:w,disabled:a.portada!==""}),e.jsx("button",{type:"reset",onClick:c,className:"bg-red-500 text-white font-bold py-1 px-2 rounded",children:"X"})]})]})]})]})]}),e.jsxs("div",{className:"flex justify-end mt-4",children:[e.jsx("button",{type:"button",onClick:n,className:"bg-red-700 text-white font-bold py-2 px-4 rounded mr-2",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"bg-black text-white font-bold py-2 px-4 rounded",children:"Guardar"})]})]}),e.jsx("button",{onClick:()=>p(!1),className:"absolute top-0 right-0 p-4",children:"X"})]})})]})},M=I;function q({auth:s,books:b,libraries:p}){const[i,x]=u.useState(()=>localStorage.getItem("view")||"cards"),[j,m]=u.useState(!1),[a,o]=u.useState(!0);u.useEffect(()=>{localStorage.setItem("view",i)},[i]);const f={titulo:"",autor:"",serie:"",num_serie:"",descripcion:"",paginas:"",portada:"",url_portada:""},{data:r,errors:C,setData:n,post:N}=k(f),[c,h]=u.useState({});u.useEffect(()=>{setTimeout(()=>{o(!1)},2e3)},[]);const w=()=>{const t={};return r.titulo.trim()||(t.titulo="El título es obligatorio."),r.autor.trim()||(t.autor="El autor es obligatorio."),r.descripcion.trim()||(t.descripcion="La descripción es obligatoria."),r.paginas||(t.paginas="Las páginas son obligatorias."),!r.portada&&!r.url_portada&&delete t.portada,h(t),Object.keys(t).length===0},y=async t=>{t.preventDefault(),w()&&(await N("/store/books",r),m(!1),n({...f}))},l=t=>{m(!1),n({...f}),h({})},g=()=>{n("portada","")},d=()=>{n("url_portada","")},v=t=>{n("portada",t.target.files[0])},S=t=>{n("url_portada",t.target.value)};return e.jsxs(E,{user:s.user,children:[e.jsx(F,{title:"Gestionar Libros"}),a?e.jsx("div",{className:"w-full h-screen flex items-center justify-center",children:e.jsx(U,{})}):e.jsxs("div",{id:"cards",className:`w-full ${i==="cards"?"flex":"hidden"} pt-24 flex-col items-center justify-center pb-3 bg-white`,children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-12",children:b.map(t=>e.jsx(M,{book:t,libraries:p},t.id))}),e.jsx("div",{className:"fixed bottom-10 right-10 rounded-full",children:e.jsx(L,{color:"bg-black",onClick:()=>m(!0)})})]}),j&&e.jsx("div",{id:"crear",className:"fixed inset-0 z-50 overflow-auto bg-gray-500 bg-opacity-75 flex items-center justify-center",children:e.jsxs("div",{className:"w-full max-w-4xl p-8 bg-white m-6 rounded shadow-lg relative mt-44 md:mt-10",children:[e.jsxs("form",{onSubmit:y,encType:"multipart/form-data",className:"w-full flex flex-col gap-4",children:[e.jsxs("div",{className:"w-full flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"w-full md:w-[50%]",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"titulo",className:"block text-sm font-medium text-gray-700",children:"Título"}),e.jsx("input",{id:"titulo",type:"text",className:"shadow appearance-none border rounded w-full py-2 px-3 text-black focus:outline-none focus:ring-2 focus:ring-metal",value:r.titulo,onChange:t=>n("titulo",t.target.value)}),c.titulo&&e.jsx("p",{className:"text-red-500 text-xs italic",children:c.titulo})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"autor",className:"block text-sm font-medium text-gray-700",children:"Autor"}),e.jsx("input",{id:"autor",type:"text",className:"shadow appearance-none border rounded w-full py-2 px-3 text-black focus:outline-none focus:ring-2 focus:ring-metal",value:r.autor,onChange:t=>n("autor",t.target.value)}),c.autor&&e.jsx("p",{className:"text-red-500 text-xs italic",children:c.autor})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"serie",className:"block text-sm font-medium text-gray-700",children:"Serie"}),e.jsx("input",{id:"serie",type:"text",className:"shadow appearance-none border rounded w-full py-2 px-3 text-black focus:outline-none focus:ring-2 focus:ring-metal",value:r.serie,onChange:t=>n("serie",t.target.value)})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"num_serie",className:"block text-sm font-medium text-gray-700",children:"Número de Serie"}),e.jsx("input",{id:"num_serie",type:"number",className:"shadow appearance-none border rounded w-full py-2 px-3 text-black focus:outline-none focus:ring-2 focus:ring-metal",value:r.num_serie,onChange:t=>n("num_serie",t.target.value)})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"paginas",className:"block text-sm font-medium text-gray-700",children:"Páginas"}),e.jsx("input",{id:"paginas",type:"number",className:"shadow appearance-none border rounded w-full py-2 px-3 text-black focus:outline-none focus:ring-2 focus:ring-metal",value:r.paginas,onChange:t=>n("paginas",t.target.value)}),c.paginas&&e.jsx("p",{className:"text-red-500 text-xs italic",children:c.paginas})]})]}),e.jsxs("div",{className:"w-full md:w-[50%] flex flex-col gap-3",children:[e.jsxs("div",{className:"mb-4 h-full",children:[e.jsx("label",{htmlFor:"descripcion",className:"block text-sm font-medium text-gray-700",children:"Descripción"}),e.jsx("textarea",{id:"descripcion",className:"shadow appearance-none border rounded w-full h-full py-2 px-3 text-black focus:outline-none focus:ring-2 focus:ring-metal",value:r.descripcion,onChange:t=>n("descripcion",t.target.value)}),c.descripcion&&e.jsx("p",{className:"text-red-500 text-xs italic text-end",children:c.descripcion})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"portada",className:"block text-sm font-medium text-gray-700",children:"Portada"}),e.jsxs("div",{className:"flex flex-row gap-2 justify-center items-center",children:[e.jsx("input",{id:"portada",type:"file",className:"shadow appearance-none border rounded w-full py-2 px-3 text-black focus:outline-none focus:ring-2 focus:ring-metal",onChange:v,disabled:r.url_portada!==""}),e.jsx("button",{type:"reset",onClick:g,className:"bg-red-500 text-white font-bold py-1 px-2 rounded",children:"X"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"url_portada",className:"block text-sm font-medium text-gray-700",children:"URL de la Portada"}),e.jsxs("div",{className:"flex flex-row gap-2 justify-center items-center",children:[e.jsx("input",{id:"url_portada",type:"text",className:"shadow appearance-none border rounded w-full py-2 px-3 text-black focus:outline-none focus:ring-2 focus:ring-metal",value:r.url_portada,onChange:S,disabled:r.portada!==""}),e.jsx("button",{type:"reset",onClick:d,className:"bg-red-500 text-white font-bold py-1 px-2 rounded",children:"X"})]})]})]})]})]}),e.jsxs("div",{className:"flex justify-end mt-4",children:[e.jsx("button",{type:"button",onClick:l,className:"bg-red-700 text-white font-bold py-2 px-4 rounded mr-2",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"bg-black text-white font-bold py-2 px-4 rounded",children:"Añadir Libro"})]})]}),e.jsx("button",{onClick:()=>m(!1),className:"absolute top-0 right-0 p-4",children:"X"})]})})]})}export{q as default};
