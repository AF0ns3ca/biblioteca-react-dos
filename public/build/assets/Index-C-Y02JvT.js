import{r as i,j as e,Y as k}from"./app-BZrr-U3K.js";import{A as S,d as N}from"./AuthenticatedLayout-BtXSofY-.js";import{d as g}from"./index-ChmhcNoT.js";import{d as E}from"./Delete-VIk3IR_r.js";import{d as F}from"./Edit-C-_-zzC5.js";import{A as $}from"./AddButton-CJQ-397H.js";import"./Footer-BV1Lm9-O.js";import"./transition-DQ32GuLJ.js";const z=({auth:l,library:s})=>{const[j,r]=i.useState(!1),[o,b]=i.useState(s.nombre),[m,n]=i.useState(s.tipo),[x,f]=i.useState(""),h=async a=>{confirm(`¿Estás seguro de que deseas eliminar la biblioteca ${s.nombre}?`)&&await g.Inertia.delete(route("libraries.destroy",{id:a}),{onSuccess:()=>{window.location.reload()}})};i.useEffect(()=>{b(s.nombre),n(s.tipo)},[s]);const p=a=>{if(a.preventDefault(),o.trim())f("");else{f("El nombre es obligatorio.");return}g.Inertia.put(route("libraries.update",{id:s.id}),{nombre:o,tipo:m},{preserveScroll:!0,onSuccess:d=>{console.log("Respuesta del servidor:",d),r(!1)},onError:d=>{d.error==="No puedes tener más de 5 bibliotecas."?alert(d.error):alert(Object.values(d).flat().join(`
`))}})},c=l.user.role==="user"?"bg-metal":"bg-premium";return e.jsxs("div",{className:"w-full sm:min-w-[304px] flex flex-col items-center justify-between bg-white shadow border min-w-[320px] hover:bg-slate-300 rounded-lg",children:[e.jsx("div",{className:"w-full flex flex-col items-start justify-center gap-1",children:s.tipo==="Fisica"?e.jsx("img",{src:"/images/fisica2.jpg",alt:"",className:"rounded-t"}):e.jsx("img",{src:"/images/digital2.png",alt:"",className:"rounded-t"})}),e.jsxs("div",{className:"w-full flex-1 flex flex-row items-start justify-center p-3",children:[e.jsx("div",{className:"w-full flex-1 flex flex-col items-start justify-center p-2",children:s.books_count>0?e.jsxs("a",{href:route("libraries.show",s.id),className:"w-full cursor-pointer flex flex-col items-start",children:[e.jsx("h1",{className:"text-xl font-bold",children:s.nombre}),e.jsxs("p",{className:"text-gray-600",children:[s.books_count," libros"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-xl font-bold",children:s.nombre}),e.jsx("p",{className:"text-gray-600",children:"Vacía"})]})}),e.jsxs("div",{className:"flex flex-row p-2 gap-3",children:[e.jsx("button",{onClick:()=>r(!0),title:"Editar biblioteca",className:`${c} text-white p-2 rounded-md w-full`,children:e.jsx(F,{})}),e.jsx("button",{onClick:()=>h(s.id),className:"bg-red-500 text-white rounded p-2",children:e.jsx(E,{})})]})]}),j&&e.jsx("div",{id:"modal-background",className:"fixed inset-0 z-50 overflow-auto bg-gray-500 bg-opacity-75 flex items-center justify-center",onClick:()=>r(!1),children:e.jsxs("div",{className:"relative p-8 bg-white w-full max-w-md m-6 rounded shadow-lg",onClick:a=>a.stopPropagation(),children:[e.jsxs("form",{onSubmit:p,className:"w-full",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"nombre",className:"block text-gray-700 text-sm font-bold mb-2",children:"Nombre"}),e.jsx("input",{id:"nombre",type:"text",className:"shadow appearance-none border rounded w-full py-2 px-3 text-black leading-tight focus:outline-none focus:shadow-outline",value:o,onChange:a=>b(a.target.value)}),x&&e.jsx("p",{className:"text-red-500 italic",children:x})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"tipo",className:"block text-gray-700 text-sm font-bold mb-2",children:"Tipo"}),e.jsxs("select",{id:"tipo",value:m,onChange:a=>n(a.target.value),className:"shadow border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline",children:[e.jsx("option",{value:"Fisica",children:"Física"}),e.jsx("option",{value:"Digital",children:"Digital"})]})]}),e.jsxs("div",{className:"w-full flex items-center justify-center gap-5",children:[e.jsx("button",{type:"submit",className:`w-full ${c} text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline`,children:"Guardar"}),e.jsx("button",{type:"button",onClick:()=>r(!1),className:"w-full bg-red-500 text-white rounded px-4 py-2",children:"Cancelar"})]})]}),e.jsx("button",{onClick:()=>r(!1),className:"absolute top-0 right-0 p-4",children:"X"})]})})]})},A=z;function B({auth:l,librariesWithBookCount:s,role:j}){const[r,o]=i.useState(!1),[b,m]=i.useState(!1),[n,x]=i.useState(""),[f,h]=i.useState("Fisica"),[p,c]=i.useState(""),a=t=>{if(t.preventDefault(),n.trim())c("");else{c("El nombre es obligatorio.");return}if(s.some(u=>u.nombre===n)){c("Ya existe una biblioteca con ese nombre.");return}else c("");g.Inertia.post("/libraries",{nombre:n,tipo:f},{preserveScroll:!0,onSuccess:u=>{console.log("Respuesta del servidor:",u),x(""),h("Fisica")},onError:u=>{u.error==="No puedes tener más de 5 bibliotecas."?alert(u.error):alert(Object.values(u).flat().join(`
`))}}),o(!1)},d=t=>{t.target.id==="modal-background"&&o(!1)},v=()=>{m(!0)},y=()=>{g.Inertia.visit("/premium"),m(!1)},C=t=>{t.target.id==="modal-alert"&&m(!1)},w=l.user.role==="user"?"bg-metal":"bg-premium";return l.user.role,e.jsxs(S,{user:l.user,role:j,children:[e.jsx(k,{title:"Bibliotecas"}),e.jsxs("div",{className:"w-full mt-20 h-full flex flex-col justify-center items-center",children:[s.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center my-10",children:[e.jsxs("h1",{className:"text-3xl mb-4",children:["¡Bienvenido a BookNest, ",l.user.name,"!"]}),e.jsx("p",{className:"text-lg mb-4",children:"Parece que aún no has creado ninguna biblioteca. Crea una para empezar a organizar tus libros y disfrutar de todas las funciones que ofrece BookNest."}),e.jsx("button",{className:"bg-metal text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",onClick:()=>o(!0),children:"Crear biblioteca"})]}),s.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("h1",{className:"p-5 text-5xl font-serif",children:["Tus bibliotecas, ",l.user.name]}),e.jsx("div",{className:"w-full px-5 sm:w-[90%] md:w-[90%] lg:w-[80%] xl:w-[70%] flex items-center justify-center py-4 ",children:e.jsx("div",{className:"w-full grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 place-content-center gap-10",children:s.map(t=>e.jsx(A,{library:t,auth:l},t.id))})})]}),(s.length<5&&l.user.role==="user"||l.user.role!=="user")&&e.jsx("div",{className:"fixed bottom-10 right-10 rounded-full",children:e.jsx($,{color:w,onClick:()=>o(!0)})}),s.length>=5&&l.user.role==="user"&&e.jsxs("div",{children:[e.jsx("div",{className:`fixed bottom-10 right-10 rounded-full ${w} p-4 text-white`,onClick:v,children:e.jsx(N,{})}),b&&e.jsx("div",{id:"modal-alert",className:"fixed inset-0 z-50 overflow-auto bg-gray-500 bg-opacity-75 flex items-center justify-center",onClick:C,children:e.jsxs("div",{className:"relative p-8 bg-white w-full max-w-md m-6 rounded shadow-lg flex flex-col gap-5 font-serif text-lg",children:[e.jsx("p",{children:"Has llegado al límite de bibliotecas. Para crear más bibliotecas, actualiza a una cuenta premium."}),e.jsx("button",{children:e.jsx(N,{sx:{fill:"#602F6B",fontSize:"35px"},onClick:y,className:"text-center rounded-ful m-3"})})]})})]})]}),r&&e.jsx("div",{id:"modal-background",className:"fixed inset-0 z-50 overflow-auto bg-gray-500 bg-opacity-75 flex items-center justify-center",onClick:d,children:e.jsxs("div",{className:"relative p-8 bg-white w-full max-w-md m-6 rounded shadow-lg",children:[e.jsxs("form",{onSubmit:a,className:"w-full",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"nombre",className:"block text-gray-700 text-sm font-bold mb-2",children:"Nombre"}),e.jsx("input",{id:"nombre",type:"text",className:"shadow appearance-none border rounded w-full py-2 px-3 text-black focus:outline-metallight leading-tight focus:outline-none focus:shadow-outline",value:n,onChange:t=>x(t.target.value)}),p&&e.jsx("p",{className:"text-red-500 italic",children:p})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"tipo",className:"block text-gray-700 text-sm font-bold mb-2",children:"Tipo"}),e.jsxs("select",{id:"tipo",value:f,onChange:t=>h(t.target.value),className:"shadow border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline",children:[e.jsx("option",{value:"Fisica",children:"Física"}),e.jsx("option",{value:"Digital",children:"Digital"})]})]}),e.jsxs("div",{className:"w-full flex items-center justify-center gap-5",children:[e.jsx("button",{type:"submit",className:`w-full ${w} text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline`,children:"Crear"}),e.jsx("button",{onClick:()=>o(!1),className:"w-full bg-red-500 text-white rounded px-4 py-2",children:"Cancelar"})]})]}),e.jsx("button",{onClick:()=>o(!1),className:"absolute top-0 right-0 p-4",children:"X"})]})})]})}export{B as default};
